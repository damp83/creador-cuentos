<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taller de Cuentos Interactivo con IA</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&family=Merriweather:wght@400;700&family=Fredoka+One&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="storybook-container">
        <aside class="sidebar">
            <div class="sidebar-header"><i data-lucide="book-heart"></i><span>Taller de Cuentos</span></div>
            <nav class="sidebar-nav">
                <ul id="main-nav">
                    <li><a href="#" class="nav-link" data-view="creator"><i data-lucide="pencil"></i> Taller</a></li>
                    <li><a href="#" class="nav-link" data-view="library"><i data-lucide="library"></i> Mi Biblioteca</a></li>
                </ul>
                <hr>
                <ul id="creator-nav" style="display: none;">
                    <li><a href="#" class="nav-link" data-step="1"><i data-lucide="sparkles"></i> Idea</a></li>
                    <li><a href="#" class="nav-link" data-step="2"><i data-lucide="user-round"></i> Personajes</a></li>
                    <li><a href="#" class="nav-link" data-step="3"><i data-lucide="mountain-snow"></i> Escenario</a></li>
                    <li><a href="#" class="nav-link" data-step="4"><i data-lucide="align-left"></i> Introducción</a></li>
                    <li><a href="#" class="nav-link" data-step="5"><i data-lucide="align-center"></i> Desarrollo</a></li>
                    <li><a href="#" class="nav-link" data-step="6"><i data-lucide="align-right"></i> Desenlace</a></li>
                    <li><a href="#" class="nav-link" data-step="7"><i data-lucide="award"></i> Final</a></li>
                    <li><a href="#" class="nav-link" data-step="8"><i data-lucide="book-open-check"></i> Resultado</a></li>
                </ul>
            </nav>
        </aside>

        <div id="creator-view" class="main-content-wrapper">
            <div class="steps-container">
                <section id="step1" class="main-content">
                    <div class="step-header"><h2>¡Empecemos la Aventura!</h2><p>Toda gran historia necesita una chispa de inspiración.</p></div>
                    <div class="step-content">
                        <button id="idea-generator-btn" class="nav-btn"><i data-lucide="shuffle"></i>Generar una idea loca</button>
                        <div class="idea-card-container">
                            <div class="idea-card"><h4>PERSONAJE</h4><p id="idea-char"></p></div>
                            <div class="idea-card"><h4>LUGAR</h4><p id="idea-place"></p></div>
                            <div class="idea-card"><h4>MISIÓN</h4><p id="idea-mission"></p></div>
                        </div>
                    </div>
                </section>
                <section id="step2" class="main-content">
                    <div class="step-header"><h2>Crea tus Personajes</h2><p>Diseña a los protagonistas de tu increíble historia.</p></div>
                    <div class="step-content">
                        <div class="character-tabs" id="character-tabs"></div>
                        <div class="character-builder">
                            <div class="avatar-preview-wrapper">
                                <div class="avatar-preview" id="avatar-preview"></div>
                                <div class="form-group" style="width:100%; margin-top: 15px;">
                                    <label for="char-name">Nombre del Personaje</label>
                                    <input type="text" id="char-name" placeholder="Escribe un nombre">
                                </div>
                            </div>
                            <div class="avatar-options">
                                <div class="builder-mode-toggle">
                                    <button class="mode-btn active" data-mode="manual">Manual</button>
                                    <button class="mode-btn" data-mode="ai">Crear con IA ✨</button>
                                </div>
                                <div id="manual-builder">
                                    <div class="option-group"><h4>Cuerpo</h4><div class="option-buttons" id="body-options"></div></div>
                                    <div class="option-group"><h4>Pelo</h4><div class="option-buttons" id="hair-options"></div></div>
                                    <div class="option-group"><h4>Ojos</h4><div class="option-buttons" id="eyes-options"></div></div>
                                    <div class="option-group"><h4>Ropa</h4><div class="option-buttons" id="clothing-options"></div></div>
                                </div>
                                <div id="ai-builder">
                                    <p>Usa el asistente para describir el personaje que imaginas.</p>
                                    <button id="open-ai-assistant-btn" class="nav-btn" style="background-color: var(--ai-color);">Abrir Asistente de Creación IA</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                <section id="step3" class="main-content">
                    <div class="step-header"><h2>Elige el Escenario</h2><p>Selecciona un mundo o crea uno nuevo con la magia de la IA.</p></div>
                    <div class="step-content">
                        <div class="selection-grid" id="scenario-selector">
                           <div class="selection-card" data-value="un bosque encantado">
                               <svg viewBox="0 0 200 150" xmlns="http://www.w3.org/2000/svg"><rect width="200" height="150" fill="#a8e6cf"/><path d="M40 150 C 40 100, 60 100, 60 150 Z" fill="#3c6255"/><path d="M80 150 C 80 90, 110 90, 110 150 Z" fill="#61876e"/><path d="M130 150 C 130 110, 150 110, 150 150 Z" fill="#3c6255"/><circle cx="170" cy="40" r="15" fill="#ffd3b6"/><circle cx="30" cy="30" r="10" fill="#ffaaa5"/></svg>
                               <span>Bosque Encantado</span>
                           </div>
                           <div class="selection-card" data-value="un castillo misterioso">
                               <svg viewBox="0 0 200 150" xmlns="http://www.w3.org/2000/svg"><rect width="200" height="150" fill="#dcedc1"/><path d="M50 150 L 50 80 L 80 50 L 120 50 L 150 80 L 150 150 Z" fill="#b0aac0"/><rect x="85" y="110" width="30" height="40" fill="#797a7e"/><path d="M50 80 L 30 80 L 30 60 L 50 60 Z" fill="#b0aac0"/><path d="M150 80 L 170 80 L 170 60 L 150 60 Z" fill="#b0aac0"/><circle cx="180" cy="20" r="10" fill="#f9f871"/></svg>
                               <span>Castillo Misterioso</span>
                           </div>
                           <div class="selection-card" data-value="un planeta de dulces">
                               <svg viewBox="0 0 200 150" xmlns="http://www.w3.org/2000/svg"><rect width="200" height="150" fill="#ffc0cb"/><path d="M0 150 C 50 100, 150 100, 200 150 Z" fill="#7b3f00"/><circle cx="50" cy="80" r="20" fill="#ff69b4"/><path d="M40 80 L 60 80 L 50 40 Z" fill="#ff69b4"/><circle cx="150" cy="90" r="25" fill="#fdfd96"/><path d="M140 90 L 160 90 L 150 50 Z" fill="#fdfd96"/></svg>
                               <span>Planeta de Dulces</span>
                           </div>
                           <div class="selection-card" id="ai-scenario-card" data-value="un lugar mágico generado por IA">
                                <i data-lucide="sparkles" style="width: 60px; height: 60px; color: var(--ai-color);"></i>
                                <span>Crear con IA</span>
                           </div>
                        </div>
                    </div>
                </section>
                <section id="step4" class="main-content">
                    <div class="step-header"><h2>Página 1: La Introducción</h2><p>Presenta a tus personajes y el lugar donde empieza todo.</p></div>
                    <div class="step-content writing-page">
                        <div class="writing-area">
                            <div class="form-group" style="flex-grow: 1; display: flex; flex-direction: column;">
                                <div class="writing-tools"><label for="plot-start">Escribe el comienzo de tu historia...</label><button class="tool-btn idea-btn" data-target="plot-start" title="Dame una idea"><i data-lucide="lightbulb"></i></button></div>
                                <textarea id="plot-start" placeholder="Había una vez..." style="flex-grow: 1;"></textarea>
                                <div class="writing-challenge" data-target="plot-start"></div>
                            </div>
                        </div>
                        <div class="illustration-area">
                            <div class="illustration-preview" id="preview-intro"></div>
                            <button class="nav-btn illustrate-btn" data-page="introduction" style="background-color: var(--ai-color);"><i data-lucide="image-plus"></i> Ilustrar Escena</button>
                        </div>
                    </div>
                </section>
                <section id="step5" class="main-content">
                    <div class="step-header"><h2>Página 2: El Desarrollo</h2><p>¡Aquí ocurre la gran aventura o el problema principal!</p></div>
                     <div class="step-content writing-page">
                        <div class="writing-area">
                            <div class="form-group" style="flex-grow: 1; display: flex; flex-direction: column;">
                                <div class="writing-tools"><label for="plot-middle">¿Qué pasó después?</label><button class="tool-btn idea-btn" data-target="plot-middle" title="Dame una idea"><i data-lucide="lightbulb"></i></button></div>
                                <textarea id="plot-middle" placeholder="De repente, ocurrió algo inesperado..." style="flex-grow: 1;"></textarea>
                                <div class="writing-challenge" data-target="plot-middle"></div>
                            </div>
                        </div>
                        <div class="illustration-area">
                            <div class="illustration-preview" id="preview-dev"></div>
                            <button class="nav-btn illustrate-btn" data-page="development" style="background-color: var(--ai-color);"><i data-lucide="image-plus"></i> Ilustrar Escena</button>
                        </div>
                    </div>
                </section>
                <section id="step6" class="main-content">
                    <div class="step-header"><h2>Página 3: El Desenlace</h2><p>¿Cómo termina la historia? ¿Qué aprendieron los personajes?</p></div>
                     <div class="step-content writing-page">
                        <div class="writing-area">
                            <div class="form-group" style="flex-grow: 1; display: flex; flex-direction: column;">
                                <div class="writing-tools"><label for="plot-end">Escribe el final...</label><button class="tool-btn idea-btn" data-target="plot-end" title="Dame una idea"><i data-lucide="lightbulb"></i></button></div>
                                <textarea id="plot-end" placeholder="Finalmente..." style="flex-grow: 1;"></textarea>
                                <div class="writing-challenge" data-target="plot-end"></div>
                            </div>
                        </div>
                        <div class="illustration-area">
                            <div class="illustration-preview" id="preview-end"></div>
                            <button class="nav-btn illustrate-btn" data-page="conclusion" style="background-color: var(--ai-color);"><i data-lucide="image-plus"></i> Ilustrar Escena</button>
                        </div>
                    </div>
                </section>
                <section id="step7" class="main-content">
                    <div class="step-header"><h2>Los Toques Finales</h2><p>¡Tu cuento está casi listo! Solo falta un buen título.</p></div>
                    <div class="step-content">
                        <div class="form-group"><label for="story-title">Título del Cuento</label><input type="text" id="story-title" placeholder="El misterio del bosque encantado"></div>
                        <div class="form-group"><label for="author-name">Escrito por</label><input type="text" id="author-name" placeholder="Tu nombre"></div>
                    </div>
                </section>
                <section id="step8" class="main-content">
                    <div class="step-header"><h2>¡Tu Cuento Mágico!</h2><p>¡Felicidades, has creado una historia increíble!</p></div>
                    <div class="step-content">
                        <article class="story-preview-container"><h3 id="preview-title"></h3><p class="author-line"><em>por <span id="preview-author"></span></em></p><div id="preview-content"></div></article>
                        <div class="final-buttons"><button id="save-to-library-btn" class="nav-btn"><i data-lucide="save"></i> Guardar en mi Biblioteca</button><button id="restart-btn" class="nav-btn"><i data-lucide="rotate-cw"></i> Crear otro</button></div>
                    </div>
                </section>
            </div>
            <div class="navigation"><button id="prev-btn" class="nav-btn" disabled><i data-lucide="arrow-left"></i> Atrás</button><button id="next-btn" class="nav-btn">Siguiente <i data-lucide="arrow-right"></i></button></div>
        </div>

        <div id="library-view" class="main-content-wrapper">
             <div class="step-header" style="padding: 40px 40px 0 40px;"><h2>Mi Biblioteca de Cuentos</h2><p>Aquí están todas las aventuras que has creado.</p></div>
            <div id="bookshelf"></div>
            <button id="new-story-from-library-btn" class="nav-btn"><i data-lucide="plus-circle"></i> Crear un Cuento Nuevo</button>
        </div>
    </div>
    
    <div class="modal-overlay" id="rhyme-modal">
        <div class="modal-content">
            <h3>Diccionario de Rimas</h3>
            <p>Escribe una palabra para encontrar otras que rimen.</p>
            <input type="text" id="rhyme-input" placeholder="Ej: canción">
            <div id="rhyme-results"></div>
            <button id="close-rhyme-modal" class="nav-btn" style="margin-top: 20px;">Cerrar</button>
        </div>
    </div>

    <div class="modal-overlay" id="ai-character-modal">
        <div class="modal-content">
            <h3>Asistente de Creación IA</h3>
            <p>¡Describe el personaje de tus sueños y la IA lo dibujará para ti!</p>
            <div class="modal-grid">
                <div class="form-group">
                    <label for="ai-char-type">Tipo de personaje</label>
                    <select id="ai-char-type">
                        <option value="un zorro">Zorro</option>
                        <option value="un robot">Robot</option>
                        <option value="un mago">Mago</option>
                        <option value="una princesa">Princesa</option>
                        <option value="un caballero">Caballero</option>
                        <option value="un dragón bebé">Dragón bebé</option>
                    </select>
                </div>
                 <div class="form-group">
                    <label for="ai-char-hair">Pelo</label>
                    <select id="ai-char-hair">
                        <option value="pelo corto y azul">Corto y azul</option>
                        <option value="pelo largo y rosa">Largo y rosa</option>
                        <option value="pelo rizado y de arcoíris">Rizado y de arcoíris</option>
                        <option value="sin pelo">Sin pelo</option>
                    </select>
                </div>
                <div class="form-group modal-full-width">
                    <label for="ai-char-clothing">¿Qué ropa lleva?</label>
                    <input type="text" id="ai-char-clothing" placeholder="Ej: una armadura brillante">
                </div>
                <div class="form-group modal-full-width">
                    <label for="ai-char-feature">Añade un rasgo especial</label>
                    <input type="text" id="ai-char-feature" placeholder="Ej: con unas pequeñas alas de hada">
                </div>
            </div>
            <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                <button id="close-ai-modal" class="nav-btn" style="background-color: #a0aec0;">Cerrar</button>
                <button id="generate-ai-avatar-btn" class="nav-btn" style="background-color: var(--ai-color);">Crear Personaje</button>
            </div>
        </div>
    </div>
    
    <div class="modal-overlay" id="ai-scene-modal">
        <div class="modal-content">
            <h3>Asistente de Ilustración de Escenas</h3>
            <p>Describe el mundo de tu historia y la IA lo dibujará.</p>
            <div class="form-group">
                <label for="ai-scene-prompt">¿Qué está pasando en esta parte de la historia?</label>
                <textarea id="ai-scene-prompt" rows="4" placeholder="Ej: El zorro pirata navega en su barco por un mar de chocolate bajo una luna de queso."></textarea>
            </div>
            <div style="display: flex; justify-content: space-between; margin-top: 20px;">
                <button id="close-ai-scene-modal" class="nav-btn" style="background-color: #a0aec0;">Cerrar</button>
                <button id="generate-ai-scene-btn" class="nav-btn" style="background-color: var(--ai-color);">Ilustrar Escena</button>
            </div>
        </div>
    </div>

    <script src="main.js"></script>
</body>
</html>
